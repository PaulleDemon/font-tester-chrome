(()=>{chrome.runtime.onInstalled.addListener((e=>{"install"===e.reason&&chrome.tabs.create({url:"https://font-tester.foxcraft.tech/thank-you"})}));let e=!1;function r(){const e=document.getElementById("font-selector-root"),r=document.getElementById("font-tester-script");e&&e.remove(),r&&r.remove()}chrome.action.onClicked.addListener((t=>{e?chrome.scripting.executeScript({target:{tabId:t.id},function:r},(()=>{chrome.runtime.lastError?console.error(chrome.runtime.lastError.message):e=!1})):chrome.scripting.executeScript({target:{tabId:t.id},files:["content.js"]},(r=>{chrome.runtime.lastError?console.error(chrome.runtime.lastError.message):e=!0}))})),chrome.runtime.onMessage.addListener(((t,s,o)=>{if("saveSettings"===t.action){const e=t.settings;return chrome.storage.local.set({settings:e},(()=>{chrome.runtime.lastError?(console.error("Error saving settings:",chrome.runtime.lastError),o({success:!1,error:chrome.runtime.lastError.message})):o({success:!0})})),!0}if("addLicenseKey"===t.action)return chrome.storage.local.set({licenseDetails:t.licenseDetails},(function(){chrome.runtime.lastError?o({success:!1,error:chrome.runtime.lastError.message}):o({success:!0})})),!0;if("removeLicenseKey"===t.action)return chrome.storage.local.remove("licenseDetails",(function(){o({success:!0})})),!0;if("getLicenseDetails"===t.action)return chrome.storage.local.get("licenseDetails",(function(e){chrome.runtime.lastError?(console.error("Error retrieving settings:",chrome.runtime.lastError),o({success:!1,error:chrome.runtime.lastError.message})):o({success:!0,licenseDetails:e.licenseDetails})})),!0;if("getSettings"===t.action)return chrome.storage.local.get("settings",(e=>{chrome.runtime.lastError?(console.error("Error retrieving settings:",chrome.runtime.lastError),o({success:!1,error:chrome.runtime.lastError.message})):o({success:!0,settings:e.settings})})),!0;if("saveFonts"===t.action){const e=t.fonts;return chrome.storage.local.set({fonts:e},(()=>{chrome.runtime.lastError?(console.error("Error saving fonts:",chrome.runtime.lastError),o({success:!1,error:chrome.runtime.lastError.message})):o({success:!0})})),!0}if("getFonts"===t.action)return chrome.storage.local.get("fonts",(e=>{chrome.runtime.lastError?o({success:!1,error:chrome.runtime?.lastError?.message}):o({success:!0,fonts:e.fonts})})),!0;"widgetClosed"===t.action&&(e=!1,chrome.scripting.executeScript({target:{tabId:s.tab?.id},function:r},(()=>{chrome.runtime.lastError?console.error(chrome.runtime.lastError.message):e=!1})))})),chrome.runtime.setUninstallURL("https://tally.so/r/mKLXVX")})();